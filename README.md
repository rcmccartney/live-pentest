# Project 8 - Pentesting Live Targets

Time spent: **3** hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## Blue

### Vulnerability #1: SQLi

Here, the ID param is vulnerable to SQL injection.  Using the syntax, `id=' or 1=1 limit 3,1;-- '`
we are able to grab the third row from the database.

![](sqli.gif)


### Vulnerability #2: Session Hijacking

Here you can see the Chrome browser (good user) and IE (hacker)
have different session Ids. The attacker gains access to the session ID
and sets their ID to be the same. Despite having a different user agent, 
the attacker now has access to the logged-in area.

![](sessions.gif)


## Green

### Vulnerability #1: Username Enumeration

We use the fact that real users have bold error messages,
while non-users are unbolded. We could script against this
to get more usernames.

![](bold.gif)

### Vulnerability #2: XSS

You can insert the XSS payload into the Name field of the contact form
on the Green page.  This script is then stuck into the HTML of the page
that the logged-in user visits, so it is stored XSS.

![](xss.gif)


## Red

### Vulnerability #1: IDOR

You can change the id field to access data that should not be accessible.
The other two sites redirect you to the territories.php site, most likely
by checking my access to the requested page and redirecting if I am not
authorized to view it.

![](idor.gif)


### Vulnerability #2: CSRF

The red site is vulnerable to CSRF with a logged in admin. A page like the
one hosted [here](https://github.com/rcmccartney/rcmccartney.github.io/blob/master/index.html)
will submit a hidden post request to change values in the database. Note that the attacker
can use a dummy iFrame to hide the redirect of the Post form, so has no idea that the db
has been modified.

![](csrf.gif)


## Bonus

### Bonus Objective 2:

We can extend the XSS to make it modify cookies and redirect. `document.cookie="x=y"` is one way to modify their cookies in a script. Further, we can use a 
snippet like the following to cause a redirect from XSS:

```javascript
<script type="text/javascript">
  window.location.href = "http://www.yourdomain.com/somepage.html";
</script>
```

![](bonus-xss.gif)

## Notes

Describe any challenges encountered while doing the work

None
